<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Buddy | Luxury Travel Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #D4AF37;
            --dark-bg: #0f172a;
            --card-glass: rgba(15, 23, 42, 0.9);
        }
        body {
            font-family: 'Lato', sans-serif;
            background-color: #020617;
            color: #e2e8f0;
            overflow-x: hidden;
        }
        h1, h2, h3, h4, .serif {
            font-family: 'Playfair Display', serif;
        }
        .text-gold { color: var(--gold); }
        .border-gold { border-color: var(--gold); }
        
        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .search-input {
            transition: all 0.3s ease;
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(4px);
        }
        .search-input:focus {
            background: rgba(15, 23, 42, 0.9);
            border-color: var(--gold);
            box-shadow: 0 0 0 1px var(--gold);
        }

        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loader {
            border: 3px solid rgba(212, 175, 55, 0.1);
            border-left-color: var(--gold);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        #cityBackground {
            transition: opacity 0.8s ease-in-out, background-image 0.8s ease-in-out;
            z-index: 0; 
            will-change: opacity, background-image; 
        }

        /* Simplified card hover effect since images are removed */
        .simple-card {
            transition: all 0.3s ease;
        }
        .simple-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(212, 175, 55, 0.3);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col relative selection:bg-gold selection:text-black">

    <div id="cityBackground" class="fixed inset-0 bg-cover bg-center bg-no-repeat opacity-0 pointer-events-none">
        <div class="absolute inset-0 bg-slate-950/90"></div>
    </div>

    <nav class="w-full py-8 px-4 md:px-12 flex justify-between items-center absolute top-0 z-50">
        <div class="cursor-pointer group" onclick="resetApp()">
            <div class="text-xl md:text-2xl font-bold serif tracking-widest text-gold opacity-90 hover:opacity-100 transition-opacity select-none drop-shadow-lg">
                Travel Buddy <span class="text-[10px] text-gray-300 font-sans tracking-widest ml-2 uppercase border-l border-gray-400 pl-2">Luxury Edition</span>
            </div>
        </div>
    </nav>

    <main class="flex-grow w-full relative z-10 flex flex-col items-center">

        <header id="heroHeader" class="relative w-full h-[600px] flex flex-col justify-center items-center text-center px-4 mb-16 fade-in">
            
            <div class="absolute inset-0 z-0">
                <!-- Stable Background Image -->
                <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1548013146-72479768bada?auto=format&fit=crop&w=1920&q=80')] bg-cover bg-center opacity-50"></div>
                <div class="absolute inset-0 bg-gradient-to-b from-[#020617]/70 via-[#020617]/50 to-[#020617]"></div>
            </div>
            
            <div class="relative z-10 max-w-5xl mx-auto mt-10">
                <h1 class="text-5xl md:text-8xl mb-6 text-white leading-tight font-serif drop-shadow-2xl">
                    Where will your story <br/>
                    <span class="text-gold italic">begin?</span>
                </h1>
                <p class="text-sm md:text-base text-gray-200 tracking-widest mb-12 uppercase max-w-xl mx-auto drop-shadow-md">
                    Explore 280+ curated destinations across India. <br class="hidden md:inline"> Powered by Live Intelligence.
                </p>

                <form onsubmit="handleSearch(event)" class="relative w-full max-w-xl mx-auto group z-50">
                    <input 
                        type="text" 
                        id="cityInput" 
                        placeholder="Search city (e.g. Varanasi) or state..." 
                        class="search-input w-full py-4 pl-6 pr-14 rounded-full text-white placeholder-gray-300 text-sm md:text-base focus:outline-none shadow-2xl"
                        autocomplete="off"
                    >
                    <div id="loadingIndicator" class="absolute right-4 top-1/2 -translate-y-1/2 hidden">
                        <div class="loader"></div>
                    </div>
                    <button type="button" id="clearBtn" onclick="resetApp()" class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-300 hover:text-white hidden transition-colors cursor-pointer">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                    <div id="searchSuggestions" class="absolute w-full mt-2 bg-[#0f172a] rounded-xl shadow-2xl border border-slate-700 hidden overflow-hidden max-h-64 overflow-y-auto text-left z-50"></div>
                </form>

                <div id="categoryFilters" class="mt-12 flex flex-wrap justify-center gap-3 fade-in">
                    <button onclick="loadCategory('history')" class="px-6 py-2 rounded-full border border-white/20 hover:border-white/50 bg-black/20 backdrop-blur-sm text-gray-200 hover:text-white text-[10px] uppercase tracking-[0.2em] transition-all">
                        History
                    </button>
                    <button onclick="loadCategory('spiritual')" class="px-6 py-2 rounded-full border border-white/20 hover:border-white/50 bg-black/20 backdrop-blur-sm text-gray-200 hover:text-white text-[10px] uppercase tracking-[0.2em] transition-all">
                        Spiritual
                    </button>
                    <button onclick="loadCategory('island')" class="px-6 py-2 rounded-full border border-white/20 hover:border-white/50 bg-black/20 backdrop-blur-sm text-gray-200 hover:text-white text-[10px] uppercase tracking-[0.2em] transition-all">
                        Islands
                    </button>
                    <button onclick="loadCategory('beach')" class="px-6 py-2 rounded-full border border-white/20 hover:border-white/50 bg-black/20 backdrop-blur-sm text-gray-200 hover:text-white text-[10px] uppercase tracking-[0.2em] transition-all">
                        Beach
                    </button>
                    <button onclick="loadCategory('hill')" class="px-6 py-2 rounded-full border border-white/20 hover:border-white/50 bg-black/20 backdrop-blur-sm text-gray-200 hover:text-white text-[10px] uppercase tracking-[0.2em] transition-all">
                        Hills
                    </button>
                    <button onclick="loadCategory('nature')" class="px-6 py-2 rounded-full border border-white/20 hover:border-white/50 bg-black/20 backdrop-blur-sm text-gray-200 hover:text-white text-[10px] uppercase tracking-[0.2em] transition-all">
                        Nature
                    </button>
                </div>
            </div>
        </header>

        <div id="contentContainer" class="container mx-auto px-4 w-full max-w-6xl fade-in relative z-20 pb-20">

            <div id="featuredGrid" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Content injected via JS -->
            </div>

            <div id="resultView" class="hidden w-full">
                <!-- Content injected via JS -->
            </div>

        </div>

    </main>

    <footer class="mt-auto py-8 text-center border-t border-white/5 bg-[#020617] relative z-20">
        <p class="text-gold serif tracking-widest text-sm mb-2">Travel Buddy</p>
        <p class="text-gray-600 text-[10px] uppercase tracking-widest">Premium Travel Database</p>
    </footer>

    <script>
        // --- CONFIGURATION ---
        const API_URL = "https://hhh9cgm40h.execute-api.ap-south-1.amazonaws.com/stage1";
        
        // GLOBAL DEFAULT: Dark, moody, golden-hour architecture
        const DEFAULT_IMAGE = "https://images.unsplash.com/photo-1599661046289-e31897846e41?auto=format&fit=crop&w=800&q=80";

        // CATEGORY SPECIFIC DEFAULTS (Used for backgrounds only now)
        const CATEGORY_DEFAULTS = {
            'history': "https://images.unsplash.com/photo-1524492412937-b28074a5d7da?auto=format&fit=crop&w=800&q=80",
            'beach': "https://images.unsplash.com/photo-1473116763249-5643194129b6?auto=format&fit=crop&w=800&q=80",
            'hill': "https://images.unsplash.com/photo-1586351012965-861624544334?auto=format&fit=crop&w=800&q=80",
            'nature': "https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?auto=format&fit=crop&w=800&q=80",
            'spiritual': "https://images.unsplash.com/photo-1561361513-2d000a50f0dc?auto=format&fit=crop&w=800&q=80",
            'island': "https://images.unsplash.com/photo-1559128010-7c1ad6e1b6a5?auto=format&fit=crop&w=800&q=80"
        };

        const AVAILABLE_CITIES = [
            "agra", "ahmedabad", "alleppey", "amritsar", "aurangabad", "bangalore", "bhopal", 
            "bhubaneswar", "chennai", "coimbatore", "coorg", "darjeeling", "delhi", "gangtok", 
            "goa", "gokarna", "guwahati", "hampi", "hyderabad", "indore", "jaipur", "jaisalmer", 
            "jammu", "jim corbett", "jodhpur", "kanyakumari", "kanpur", "kaziranga", "kochi", 
            "kodaikanal", "kolkata", "leh", "lonavala", "lucknow", "madurai", "mahabaleshwar", 
            "manali", "mumbai", "munnar", "mussoorie", "mysore", "nagpur", "nainital", "nashik", 
            "ooty", "patna", "pondicherry", "pune", "puri", "rameswaram", "ranthambore", 
            "rishikesh", "shillong", "shimla", "srinagar", "sundarbans", "surat", "swaraj dweep", 
            "thiruvananthapuram", "tirupati", "udaipur", "vadodara", "varanasi", "visakhapatnam"
        ];

        const CITIES_AUTOCOMPLETE = AVAILABLE_CITIES.map(city => city.charAt(0).toUpperCase() + city.slice(1)).sort();

        const STATE_MAPPING = {
            "Rajasthan": ["Jaipur", "Udaipur", "Jaisalmer", "Jodhpur"],
            "Kerala": ["Munnar", "Alleppey", "Kochi", "Thiruvananthapuram", "Wayanad", "Varkala"],
            "Himachal Pradesh": ["Manali", "Shimla"],
            "Uttarakhand": ["Rishikesh", "Nainital", "Mussoorie", "Jim Corbett", "Haridwar"],
            "Karnataka": ["Bangalore", "Coorg", "Mysore", "Hampi", "Gokarna"],
            "Maharashtra": ["Mumbai", "Pune", "Lonavala", "Mahabaleshwar", "Aurangabad", "Nashik", "Nagpur"],
            "Goa": ["Goa"],
            "Tamil Nadu": ["Chennai", "Ooty", "Kodaikanal", "Madurai", "Rameswaram", "Kanyakumari", "Coimbatore"],
            "Uttar Pradesh": ["Agra", "Varanasi", "Lucknow", "Kanpur"],
            "West Bengal": ["Kolkata", "Darjeeling", "Sundarbans"],
            "Gujarat": ["Ahmedabad", "Surat", "Vadodara"],
            "Madhya Pradesh": ["Bhopal", "Indore"],
            "Odisha": ["Bhubaneswar", "Puri"],
            "Punjab": ["Amritsar"],
            "Assam": ["Guwahati", "Kaziranga"],
            "Telangana": ["Hyderabad"],
            "Andhra Pradesh": ["Tirupati", "Visakhapatnam"],
            "Jammu & Kashmir": ["Srinagar", "Jammu"],
            "Ladakh": ["Leh"],
            "Sikkim": ["Gangtok"],
            "Meghalaya": ["Shillong"],
            "Bihar": ["Patna"],
            "Puducherry": ["Pondicherry"],
            "Andaman & Nicobar": ["Swaraj Dweep"]
        };

        const CATEGORIES = {
            'history': ['Jaipur', 'Udaipur', 'Hampi', 'Agra', 'Mysore', 'Jaisalmer', 'Aurangabad', 'Delhi'],
            'spiritual': ['Varanasi', 'Rishikesh', 'Tirupati', 'Puri', 'Amritsar', 'Rameswaram', 'Haridwar', 'Madurai'],
            'island': ['Swaraj Dweep', 'Rameswaram', 'Kochi'],
            'beach': ['Goa', 'Gokarna', 'Pondicherry', 'Varkala', 'Puri', 'Kanyakumari'],
            'hill': ['Manali', 'Shimla', 'Munnar', 'Leh', 'Ooty', 'Darjeeling', 'Nainital', 'Gangtok', 'Shillong', 'Mussoorie'],
            'nature': ['Jim Corbett', 'Kaziranga', 'Alleppey', 'Coorg', 'Wayanad', 'Ranthambore', 'Sundarbans']
        };

        // STABLE IMAGE MAP - ALL CITIES MAPPED TO HIGH-QUALITY IMAGES
        const CITY_IMAGES = {
            // Spiritual (Ganga Aarti & Lamps Style)
            "varanasi": "https://images.unsplash.com/photo-1561361513-2d000a50f0dc?auto=format&fit=crop&w=800&q=80", 
            "rishikesh": "https://images.unsplash.com/photo-1518182170546-0766ce6fec56?auto=format&fit=crop&w=800&q=80", 
            "haridwar": "https://images.unsplash.com/photo-1596564633789-985d7107f240?auto=format&fit=crop&w=800&q=80", 
            "tirupati": "https://images.unsplash.com/photo-1643265814521-83c3175024b3?auto=format&fit=crop&w=800&q=80", 
            "puri": "https://images.unsplash.com/photo-1574526671043-4a307406a445?auto=format&fit=crop&w=800&q=80", 
            "amritsar": "https://images.unsplash.com/photo-1514222134-b57cbb8ce073?auto=format&fit=crop&w=800&q=80", 
            "rameswaram": "https://images.unsplash.com/photo-1624545086392-4f35f29d10e6?auto=format&fit=crop&w=800&q=80", 

            // Hills (Misty/Moody Style)
            "leh": "https://images.unsplash.com/photo-1581793745862-99fde7fa73d2?auto=format&fit=crop&w=800&q=80", 
            "ooty": "https://images.unsplash.com/photo-1559846305-654cb7863158?auto=format&fit=crop&w=800&q=80", 
            "darjeeling": "https://images.unsplash.com/photo-1544634076-a90160bc24d8?auto=format&fit=crop&w=800&q=80", 
            "manali": "https://images.unsplash.com/photo-1626621341517-bbf3d9990a23?auto=format&fit=crop&w=800&q=80", 
            "shimla": "https://images.unsplash.com/photo-1562649363-233f20815462?auto=format&fit=crop&w=800&q=80", 
            "munnar": "https://images.unsplash.com/photo-1596005554384-d293674c91d7?auto=format&fit=crop&w=800&q=80", 
            "nainital": "https://images.unsplash.com/photo-1569344427508-3a158b4f1784?auto=format&fit=crop&w=800&q=80", 

            // Beach/Island (Sunset/Dark Water Style)
            "gokarna": "https://images.unsplash.com/photo-1643194079860-264149022064?auto=format&fit=crop&w=800&q=80", 
            "pondicherry": "https://images.unsplash.com/photo-1619696570760-466d3330663f?auto=format&fit=crop&w=800&q=80", 
            "varkala": "https://images.unsplash.com/photo-1652614922159-83c3175024b3?auto=format&fit=crop&w=800&q=80", 
            "goa": "https://images.unsplash.com/photo-1615529328331-f8e5d2951f54?auto=format&fit=crop&w=800&q=80", 
            "swaraj dweep": "https://images.unsplash.com/photo-1589330273594-fade1ee91647?auto=format&fit=crop&w=800&q=80", 

            // Heritage/History (Dark/Gold Architecture)
            "agra": "https://images.unsplash.com/photo-1548013146-72479768bada?auto=format&fit=crop&w=800&q=80", 
            "delhi": "https://images.unsplash.com/photo-1587474265402-9e7926e8d658?auto=format&fit=crop&w=800&q=80", 
            "jaipur": "https://images.unsplash.com/photo-1477587458883-47145ed94245?auto=format&fit=crop&w=800&q=80", 
            "udaipur": "https://images.unsplash.com/photo-1595262369688-660c3866c117?auto=format&fit=crop&w=800&q=80", 
            "jaisalmer": "https://images.unsplash.com/photo-1516483638261-f4dbaf036963?auto=format&fit=crop&w=800&q=80", 
            "jodhpur": "https://images.unsplash.com/photo-1534234828563-02511c798782?auto=format&fit=crop&w=800&q=80", 
            "hampi": "https://images.unsplash.com/photo-1620766182966-c6eb33251735?auto=format&fit=crop&w=800&q=80", 
            "mysore": "https://images.unsplash.com/photo-1600612292802-3b7908b63480?auto=format&fit=crop&w=800&q=80", 

            // Metro/Others
            "mumbai": "https://images.unsplash.com/photo-1566552881560-0be862a7c445?auto=format&fit=crop&w=800&q=80",
            "bangalore": "https://images.unsplash.com/photo-1596176530529-78163a4f7af2?auto=format&fit=crop&w=800&q=80",
            "kolkata": "https://images.unsplash.com/photo-1558431382-27e30314225d?auto=format&fit=crop&w=800&q=80"
        };

        const dataCache = {};

        // DOM Elements
        const cityInput = document.getElementById('cityInput');
        const searchSuggestions = document.getElementById('searchSuggestions');
        const featuredGrid = document.getElementById('featuredGrid');
        const resultView = document.getElementById('resultView');
        const clearBtn = document.getElementById('clearBtn');
        const heroHeader = document.getElementById('heroHeader');
        const categoryFilters = document.getElementById('categoryFilters');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const cityBackground = document.getElementById('cityBackground');

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
            renderDefaultFeatured();
        });

        // --- SEARCH LOGIC ---
        function handleSearch(event) {
            event.preventDefault(); // Stop form submission
            const val = cityInput.value.toLowerCase().trim();
            if(!val) return;

            // Check if it matches a known State first
            const stateMatch = Object.keys(STATE_MAPPING).find(state => state.toLowerCase() === val);
            
            if (stateMatch) {
                loadState(stateMatch);
            } else {
                // Default to city search
                loadCity(val);
            }
            searchSuggestions.classList.add('hidden');
        }

        // --- API HANDLER ---
        async function fetchCityData(cityName) {
            cityName = cityName.trim().toLowerCase();
            
            if (dataCache[cityName]) return dataCache[cityName];

            loadingIndicator.classList.remove('hidden');
            clearBtn.classList.add('hidden');

            try {
                const response = await fetch(`${API_URL}?city=${encodeURIComponent(cityName)}`);
                if (!response.ok) throw new Error("Network response was not ok");
                
                const data = await response.json();
                
                loadingIndicator.classList.add('hidden');
                clearBtn.classList.remove('hidden');

                if (data.error || !data.city) return null;

                dataCache[cityName] = data;
                return data;

            } catch (error) {
                console.warn("API Connection Failed or City Not Found.", error);
                loadingIndicator.classList.add('hidden');
                clearBtn.classList.remove('hidden');
                return null; 
            }
        }

        async function loadCity(cityName) {
            const data = await fetchCityData(cityName);
            
            if (!data) {
                alert("Destination not found in our database or connection issue.");
                return;
            }

            // UI Reset
            searchSuggestions.classList.add('hidden');
            cityInput.value = data.city; 
            
            heroHeader.classList.add('hidden');
            featuredGrid.classList.add('hidden');
            resultView.classList.remove('hidden');

            // Scroll to top of content
            window.scrollTo({ top: 0, behavior: 'auto' });

            renderCityDetail(data);
        }

        async function loadState(stateName) {
            const citiesToLoad = STATE_MAPPING[stateName];
            
            if (!citiesToLoad) {
                alert("No cities found for this state.");
                return;
            }

            resetAppViewForGrid();
            
            featuredGrid.innerHTML = `
                <div class="col-span-full text-center text-gold py-20 fade-in">
                    <div class="loader mx-auto mb-4"></div>
                    <span class="text-sm tracking-widest uppercase">Fetching best spots in ${stateName}...</span>
                </div>
            `;

            const promises = citiesToLoad.map(city => fetchCityData(city));
            const results = await Promise.all(promises);

            let gridHTML = "";
            let count = 0;

            results.forEach(data => {
                if(!data) return;
                count++;
                gridHTML += createGridCard(data, stateName);
            });

            if(count === 0) {
                 featuredGrid.innerHTML = `
                <div class="col-span-full text-center text-gray-400 py-20 fade-in">
                    <p>Unable to load destinations for ${stateName} at the moment.</p>
                </div>`;
                return;
            }

            featuredGrid.innerHTML = `
                <div class="col-span-full mb-4 fade-in text-center border-b border-white/5 pb-8 pt-4">
                    <h2 class="text-4xl serif text-white capitalize mb-2">Destinations in <span class="text-gold">${stateName}</span></h2>
                    <p class="text-sm text-gray-400 tracking-widest uppercase">Found ${count} gems</p>
                </div>
                ${gridHTML}
            `;
            if (typeof lucide !== 'undefined') lucide.createIcons({ root: featuredGrid });
            featuredGrid.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function createGridCard(data, tag) {
            // Images are removed from the card layout as requested
            // We still use CITY_IMAGES for the background when the user clicks the card
            return `
            <div onclick="loadCity('${data.city}')" class="simple-card relative p-8 rounded-2xl border border-white/10 bg-white/5 hover:bg-white/10 cursor-pointer group fade-in h-[250px] flex flex-col justify-end">
                <div class="relative z-10">
                    <span class="inline-block px-3 py-1 mb-3 text-[10px] font-bold tracking-widest text-black bg-gold rounded-full uppercase">${tag}</span>
                    <h3 class="text-3xl serif text-white mb-2 group-hover:text-gold transition-colors capitalize">${data.city}</h3>
                    <p class="text-sm text-gray-300 italic mb-3">"${data.nickname}"</p>
                    <p class="text-[10px] text-gray-400 font-mono tracking-wide">Approx ${data.estimated_cost.total}</p>
                </div>
            </div>`;
        }

        function renderCityDetail(data) {
            let bgUrl = CITY_IMAGES[data.city.toLowerCase()];
            if (!bgUrl) bgUrl = DEFAULT_IMAGE;

            cityBackground.style.backgroundImage = `url('${bgUrl}')`;
            cityBackground.style.opacity = '1';

            const createTags = (arr) => arr ? arr.map(t => `<span class="px-3 py-1 bg-black/40 backdrop-blur-md rounded-full border border-white/10 text-xs text-gray-200 whitespace-nowrap">${t}</span>`).join('') : '';
            const season = data.season_breakdown || { summer: 'N/A', winter: 'N/A', monsoon: 'N/A' };
            const cost = data.estimated_cost || { total: 'N/A', stay: 'N/A', food: 'N/A', activity: 'N/A' };

            resultView.innerHTML = `
                <div class="glass-panel rounded-2xl p-6 md:p-10 border border-white/10 relative overflow-hidden fade-in mt-10">
                    <div class="flex flex-col md:flex-row justify-between items-start mb-8 border-b border-white/10 pb-6 relative z-10">
                        <div>
                            <span class="text-xs font-bold text-gold uppercase tracking-[0.2em] mb-2 block shadow-black drop-shadow-md">Destination Guide</span>
                            <h2 class="text-5xl md:text-7xl serif text-white capitalize mb-1 drop-shadow-xl">${data.city}</h2>
                            <div class="flex items-center gap-2 mb-3">
                                <i data-lucide="map-pin" class="w-4 h-4 text-gold"></i>
                                <span class="text-sm font-bold text-gray-300 uppercase tracking-widest">${data.state || 'India'}</span>
                            </div>
                            <p class="text-xl text-gray-200 italic font-serif drop-shadow-md">"${data.nickname}"</p>
                        </div>
                        <div class="mt-6 md:mt-0 flex gap-4">
                            <div class="text-center p-4 bg-black/40 backdrop-blur-sm rounded-xl border border-white/10">
                                <div class="text-xs text-gray-400 uppercase tracking-widest mb-1">Best Time</div>
                                <div class="text-lg text-gold serif font-bold">${data.best_time}</div>
                            </div>
                            <div class="text-center p-4 bg-black/40 backdrop-blur-sm rounded-xl border border-white/10">
                                <div class="text-xs text-gray-400 uppercase tracking-widest mb-1">Climate</div>
                                <div class="text-lg text-white serif">${data.climate}</div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 relative z-10">
                        <div class="lg:col-span-2 space-y-8">
                            <div>
                                <h4 class="text-gold serif text-xl mb-4 flex items-center gap-2 drop-shadow-md"><i data-lucide="star" class="w-5 h-5"></i> Famous For</h4>
                                <p class="text-lg text-white leading-relaxed mb-4 border-l-2 border-gold pl-4 bg-gradient-to-r from-gold/10 to-transparent py-2">${data.famous_for}</p>
                                <div class="flex flex-wrap gap-2">${createTags(data.best_places)}</div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-black/30 p-6 rounded-xl border border-white/10 hover:bg-black/40 transition-colors">
                                    <h4 class="text-white serif text-lg mb-4 flex items-center gap-2"><i data-lucide="utensils" class="w-4 h-4 text-gold"></i> Culinary Delights</h4>
                                    <div class="flex flex-wrap gap-2">${createTags(data.food)}</div>
                                </div>
                                <div class="bg-black/30 p-6 rounded-xl border border-white/10 hover:bg-black/40 transition-colors">
                                    <h4 class="text-white serif text-lg mb-4 flex items-center gap-2"><i data-lucide="compass" class="w-4 h-4 text-gold"></i> Markets</h4>
                                    <div class="flex flex-wrap gap-2">${createTags(data.market)}</div>
                                </div>
                            </div>
                            <div class="bg-black/30 p-6 rounded-xl border border-white/10">
                                <h4 class="text-gray-400 uppercase tracking-widest text-xs mb-4">Seasonal Conditions</h4>
                                <div class="grid grid-cols-3 gap-4 text-center">
                                    <div><div class="text-orange-400 text-xs mb-1 font-bold">SUMMER</div><div class="text-gray-300 text-sm">${season.summer}</div></div>
                                    <div class="border-l border-r border-white/10"><div class="text-cyan-400 text-xs mb-1 font-bold">WINTER</div><div class="text-gray-300 text-sm">${season.winter}</div></div>
                                    <div><div class="text-emerald-400 text-xs mb-1 font-bold">MONSOON</div><div class="text-gray-300 text-sm">${season.monsoon}</div></div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="bg-black/60 backdrop-blur-md p-8 rounded-2xl border border-gold/30 sticky top-24 shadow-2xl">
                                <div class="text-center mb-6">
                                    <h4 class="text-white serif text-2xl">Trip Budget</h4>
                                    <p class="text-xs text-gray-500 uppercase tracking-widest mt-1">Est. Cost Per Person</p>
                                </div>
                                <div class="space-y-4">
                                    <div class="flex justify-between items-center py-3 border-b border-gray-700">
                                        <span class="text-gray-400 text-sm flex items-center gap-2"><i data-lucide="home" class="w-4 h-4"></i> Stay</span>
                                        <span class="text-white font-mono">${cost.stay}</span>
                                    </div>
                                    <div class="flex justify-between items-center py-3 border-b border-gray-700">
                                        <span class="text-gray-400 text-sm flex items-center gap-2"><i data-lucide="coffee" class="w-4 h-4"></i> Food</span>
                                        <span class="text-white font-mono">${cost.food}</span>
                                    </div>
                                    <div class="flex justify-between items-center py-3 border-b border-gray-700">
                                        <span class="text-gray-400 text-sm flex items-center gap-2"><i data-lucide="camera" class="w-4 h-4"></i> Activity</span>
                                        <span class="text-white font-mono">${cost.activity}</span>
                                    </div>
                                    <div class="pt-6 mt-2">
                                        <div class="flex justify-between items-end">
                                            <span class="text-gold text-sm uppercase font-bold tracking-widest">Total / Day</span>
                                            <span class="text-3xl text-white serif">${cost.total}</span>
                                        </div>
                                    </div>
                                </div>
                                <button onclick="resetApp()" class="w-full mt-8 py-4 bg-slate-800 hover:bg-gold hover:text-slate-900 text-gold border border-gold/50 rounded-xl transition-all duration-300 uppercase tracking-widest text-xs font-bold shadow-lg hover:shadow-gold/20 cursor-pointer">
                                    Search Another
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            if (typeof lucide !== 'undefined') lucide.createIcons({ root: resultView });
        }

        async function loadCategory(tag) {
            const citiesToLoad = CATEGORIES[tag];
            resetAppViewForGrid();
            
            featuredGrid.innerHTML = `<div class="col-span-full text-center text-gold py-20 fade-in"><div class="loader mx-auto mb-4"></div><span class="text-sm tracking-widest uppercase">Fetching ${tag} destinations...</span></div>`;

            const promises = citiesToLoad.map(city => fetchCityData(city));
            const results = await Promise.all(promises);

            let gridHTML = "";
            let count = 0;

            results.forEach(data => {
                if(!data) return;
                count++;
                gridHTML += createGridCard(data, tag);
            });

            if(count === 0) {
                 featuredGrid.innerHTML = `
                <div class="col-span-full text-center text-gray-400 py-20 fade-in">
                    <p>Unable to load ${tag} destinations at the moment.</p>
                </div>`;
                return;
            }

            featuredGrid.innerHTML = `
                <div class="col-span-full mb-4 fade-in text-center border-b border-white/5 pb-8 pt-4">
                    <h2 class="text-4xl serif text-white capitalize mb-2">Curated <span class="text-gold">${tag}</span> Collection</h2>
                    <p class="text-sm text-gray-400 tracking-widest uppercase">Found ${count} destinations</p>
                </div>
                ${gridHTML}
            `;
            if (typeof lucide !== 'undefined') lucide.createIcons({ root: featuredGrid });
            featuredGrid.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function resetAppViewForGrid() {
            resultView.classList.add('hidden');
            searchSuggestions.classList.add('hidden');
            heroHeader.classList.add('hidden');
            featuredGrid.classList.remove('hidden');
        }

        // --- SEARCH HANDLERS ---
        cityInput.addEventListener('input', (e) => {
            const val = e.target.value.toLowerCase().trim();
            clearBtn.classList.toggle('hidden', val.length === 0);
            if (val.length < 2) { searchSuggestions.classList.add('hidden'); return; }
            
            const cityMatches = CITIES_AUTOCOMPLETE.filter(city => city.toLowerCase().includes(val));
            const stateMatches = Object.keys(STATE_MAPPING).filter(state => state.toLowerCase().includes(val));

            let html = '';

            // State Suggestions
            if (stateMatches.length > 0) {
                html += stateMatches.map(state => 
                    `<div onclick="loadState('${state}')" class="px-5 py-4 hover:bg-slate-800 cursor-pointer text-gray-300 border-b border-slate-700 last:border-0 flex justify-between items-center group">
                        <div>
                            <span class="capitalize font-medium group-hover:text-gold transition-colors">${state}</span>
                            <span class="text-[10px] text-gray-500 uppercase ml-2 tracking-widest border border-gray-600 px-1 rounded">STATE</span>
                        </div>
                        <i data-lucide="map" class="w-4 h-4 text-gray-500"></i>
                    </div>`
                ).join('');
            }

            // City Suggestions
            if (cityMatches.length > 0) {
                html += cityMatches.map(city => 
                    `<div onclick="loadCity('${city}')" class="px-5 py-4 hover:bg-slate-800 cursor-pointer text-gray-300 border-b border-slate-700 last:border-0 flex justify-between items-center group">
                        <span class="capitalize font-medium group-hover:text-gold transition-colors">${city}</span>
                    </div>`
                ).join('');
            }

            if (html) {
                searchSuggestions.innerHTML = html;
                searchSuggestions.classList.remove('hidden');
                if (typeof lucide !== 'undefined') lucide.createIcons({ root: searchSuggestions });
            } else {
                searchSuggestions.classList.add('hidden');
            }
        });

        function resetApp() {
            window.scrollTo(0, 0);
            cityInput.value = '';
            clearBtn.classList.add('hidden');
            searchSuggestions.classList.add('hidden');
            resultView.classList.add('hidden');
            resultView.innerHTML = '';
            cityBackground.style.opacity = '0';
            
            heroHeader.classList.remove('hidden');
            featuredGrid.classList.remove('hidden');
            
            heroHeader.classList.remove('fade-in');
            void heroHeader.offsetWidth; 
            heroHeader.classList.add('fade-in');

            renderDefaultFeatured();
        }

        function renderDefaultFeatured() {
            // Render the top 3 high-impact luxury destinations WITHOUT images inside the cards
            featuredGrid.innerHTML = `
                <div onclick="loadCity('udaipur')" class="simple-card relative p-8 rounded-2xl border border-white/10 bg-white/5 hover:bg-white/10 cursor-pointer group fade-in h-[250px] flex flex-col justify-end">
                    <div class="relative z-10">
                        <span class="inline-block px-3 py-1 mb-3 text-[10px] font-bold tracking-widest text-black bg-gold rounded-full uppercase">Royal Heritage</span>
                        <h3 class="text-3xl serif text-white mb-2 group-hover:text-gold transition-colors">Udaipur</h3>
                        <p class="text-sm text-gray-300 italic mb-3">"The City of Lakes"</p>
                        <p class="text-xs text-gray-400 font-mono tracking-wide">Approx ₹2500/day</p>
                    </div>
                </div>

                <div onclick="loadCity('munnar')" class="simple-card relative p-8 rounded-2xl border border-white/10 bg-white/5 hover:bg-white/10 cursor-pointer group fade-in h-[250px] flex flex-col justify-end">
                    <div class="relative z-10">
                        <span class="inline-block px-3 py-1 mb-3 text-[10px] font-bold tracking-widest text-black bg-emerald-400 rounded-full uppercase">Nature Escape</span>
                        <h3 class="text-3xl serif text-white mb-2 group-hover:text-emerald-400 transition-colors">Munnar</h3>
                        <p class="text-sm text-gray-300 italic mb-3">"Kashmir of South India"</p>
                        <p class="text-xs text-gray-400 font-mono tracking-wide">Approx ₹2000/day</p>
                    </div>
                </div>

                <div onclick="loadCity('varanasi')" class="simple-card relative p-8 rounded-2xl border border-white/10 bg-white/5 hover:bg-white/10 cursor-pointer group fade-in h-[250px] flex flex-col justify-end">
                    <div class="relative z-10">
                        <span class="inline-block px-3 py-1 mb-3 text-[10px] font-bold tracking-widest text-black bg-orange-400 rounded-full uppercase">Spiritual</span>
                        <h3 class="text-3xl serif text-white mb-2 group-hover:text-orange-400 transition-colors">Varanasi</h3>
                        <p class="text-sm text-gray-300 italic mb-3">"The City of Lights"</p>
                        <p class="text-xs text-gray-400 font-mono tracking-wide">Approx ₹2200/day</p>
                    </div>
                </div>
            `;
            if (typeof lucide !== 'undefined') lucide.createIcons({ root: featuredGrid });
        }
    </script>
</body>
</html>